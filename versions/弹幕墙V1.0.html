<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>弹幕墙--郑常龙</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="https://www.mike652638.com/projects/danmu/">
    <link rel="shortcut icon" href="https://www.mike652638.com/wp-content/uploads/2017/02/2017020715053649.png" />
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style type="text/css">
    /**个人原创: Cover用于遮罩层,
 利用CSS绝对定位, top值由0变为屏幕高度(由JS得到),
 变化过程运用CSS3 transition, 达到"拉开幕布"的动画效果**/
    
    .container {
        overflow: hidden;
        /**cover层通过绝对定位跑到屏幕下方时, 超出了屏幕范围, 隐藏起来**/
    }
    
    .cover {
        background-color: #fff;
        position: absolute;
        top: 0;
        left: 0;
        height: 1000px;
        width: 100%;
        transition: all 2s ease-in;
        z-index: 99;
    }
    
    .dmArea {
        border: 1px solid #1387CE;
        width: 100%;
        margin-top: 30px;
        position: relative;
        overflow: hidden;
    }
    
    .ctrl {
        width: 100%;
        margin: 2em auto;
        text-align: center;
    }
    
    .form-control {
        width: auto !important;
    }
    
    .noBorderRds,
    .dropdown-toggle {
        border-radius: 0 !important;
    }
    
    .ipt-ctrl {
        margin: 1em auto;
    }
    
    .dropdown-menu {
        min-width: 80px;
    }
    
    .dropdown-menu a:hover {
        background-color: pink !important;
    }
    
    .selected {
        background-color: #66FFCC;
        color: #337AB7 !important;
        font-weight: bold !important;
    }
    
    .btn-margin {
        margin-right: 1em;
    }
    
    .footer {
        font-size: 1em;
        text-align: center;
    }
    
    .footer a {
        text-decoration: none;
    }
    
    @media screen and (max-width:410px) {
        .fstBtn {
            width: 100% !important;
            margin-bottom: 6px !important;
            display: block !important;
        }
        .fstIpt {
            width: 100% !important;
            margin-bottom: 10px !important;
            display: block !important;
        }
        .dmArea {
            margin-top: 10px;
        }
        .dropdown-menu {
            min-width: 100%;
            text-align: center;
        }
    }
    
    @media screen and (min-width:411px) and (max-width:600px) {
        .fstBtn {
            margin-bottom: 10px !important;
        }
        .fstIpt {
            margin-bottom: 10px !important;
        }
    }
    
    .moveToLeft {
        animation: moveToLeft 10s ease-in infinite;
        -webkit-animation: moveToLeft 10s ease-in infinite;
        /*Safari and Chrome*/
    }
    
    @keyframes moveToLeft {
        from {
            left: 0;
        }
        to {
            left: 90%;
        }
    }
    /*Safari and Chrome*/
    
    @-webkit-keyframes moveToLeft {
        from {
            left: 0;
        }
        to {
            left: 90%;
        }
    }
    
    .breathLight {
        animation: breathLight 10s ease-in infinite;
        -webkit-animation: breathLight 10s ease-in infinite;
        /*Safari and Chrome*/
    }
    
    @keyframes breathLight {
        from {
            box-shadow: 3px 5px 20px #333;
        }
        to {
            box-shadow: 5px 10px 30px #48e0d3;
        }
    }
    /*Safari and Chrome*/
    
    @-webkit-keyframes breathLight {
        from {
            box-shadow: 3px 5px 20px #333;
        }
        to {
            box-shadow: 5px 10px 30px #48e0d3;
        }
    }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-xs-10 col-xs-offset-1">
                <div class="dmArea breathLight" id="dmArea">
                </div>
                <div class="ctrl">
                    <div class="input-group form-group ipt-ctrl">
                        <div class="btn-group dropup">
                            <button type="button" class="btn btn-default dropdown-toggle fstBtn" data-toggle="dropdown">
                                快捷输入&nbsp;<span class="caret"></span>
                                <span class="sr-only">切换下拉菜单</span>
                            </button>
                            <ul class="dropdown-menu" id="fstIptLst" role="menu">
                                <li><a href="javascript:void(0)">(ಥ_ಥ)卖个萌先O(∩_∩)O</a></li>
                                <li><a href="javascript:void(0)">(*^__^*)前排合影↖(^ω^)↗</a></li>
                                <li><a href="javascript:void(0)">(ノ°ο°)ノ前方高能预警</a></li>
                                <li><a href="javascript:void(0)">QAQ您的好友光头强已上线</a></li>
                                <li><a href="javascript:void(0)">눈_눈画质感人〒_〒</a></li>
                                <li><a href="javascript:void(0)">一本正经地胡说八道(*+﹏+*)</a></li>
                                <li><a href="javascript:void(0)">前面刷屏的你够了 !!!</a></li>
                                <li><a href="javascript:void(0)">阿婆主丧心病狂{{{(>_<)}}}</a></li>
                                <li><a href="javascript:void(0)">我从未见过如此厚颜无耻之人 !</a></li>
                                <li><a href="javascript:void(0)">前面吐槽的放学别走←_←</a></li>
                                <li><a href="javascript:void(0)">牛顿的棺材板压不住了╰_╯</a></li>
                                <li><a href="javascript:void(0)">请收下我的膝盖.orZ</a></li>
                                <li><a href="javascript:void(0)">很惭愧,只做了点微小的事情 :)</a></li>
                            </ul>
                            <input type="text" class="form-control noBorderRds fstIpt" id="dmTxt" placeholder="我要吐槽 ... " />
                        </div>
                        <div class="btn-group dropup">
                            <button type="button" class="btn btn-default dropdown-toggle noBorderRds" data-toggle="dropdown">字号</button>
                            <button type="button" class="btn btn-default dropdown-toggle noBorderRds" data-toggle="dropdown">
                                <span class="caret"></span>
                                <span class="sr-only">切换下拉菜单</span>
                            </button>
                            <ul class="dropdown-menu" id="fontSizeSt" role="menu">
                                <li><a href="javascript:void(0)" class="selected">常规</a></li>
                                <li><a href="javascript:void(0)">小号</a></li>
                                <li><a href="javascript:void(0)">大号</a></li>
                                <li><a href="javascript:void(0)">超大</a></li>
                            </ul>
                        </div>
                        <div class="btn-group dropup">
                            <button type="button" class="btn btn-default dropdown-toggle noBorderRds" data-toggle="dropdown">颜色</button>
                            <button type="button" class="btn btn-default dropdown-toggle noBorderRds" data-toggle="dropdown">
                                <span class="caret"></span>
                                <span class="sr-only">切换下拉菜单</span>
                            </button>
                            <ul class="dropdown-menu" id="fontColorSt" role="menu">
                                <li><a href="javascript:void(0)" class="selected">黑色</a></li>
                                <li><a href="javascript:void(0)">蓝色</a></li>
                                <li><a href="javascript:void(0)">红色</a></li>
                                <li><a href="javascript:void(0)">绿色</a></li>
                            </ul>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-margin" id="send">发射</button>
                    <button class="btn btn-danger" id="clear">清屏</button>
                </div>
                <p class="footer">
                    <a target="_blank" href="https://www.mike652638.com/danmu-code">欢迎访问"我的网站"查看本游戏源代码</a>
                </p>
                <div class="cover" id="cover">
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    $(document).ready(function() {
        var dmAreaWidth,
            dmAreaHeight;
        var dmFontSize = "1em",
            dmFontSizeArr = ["1em", "0.8em", "1.2em", "1.6em"],
            dmFontColor = "#000",
            dmFontColorArr = ["#000", "#1387CE", "#E30278", "#019447"];
        var ftNum,
            clrNum;

        $("#dmArea").css("height", $(window).height() * 0.6);
        dmAreaWidth = $("#dmArea").width() - 50;
        dmAreaHeight = $("#dmArea").height() - 50;

        $("#cover").css("top", $(window).height());

        $(window).resize(function() {
            $("#dmArea").css("height", $(window).height() * 0.6);
            dmAreaWidth = $("#dmArea").width() - 50;
            dmAreaHeight = $("#dmArea").height() - 50;
            $("#cover").css("top", $(window).height());
        });

        function chgFontSize() {
            dmFontSize = dmFontSizeArr[ftNum];
            $("#fontSizeSt a").removeClass("selected");
            $("#fontSizeSt a").eq(ftNum).addClass("selected");
        }

        function chgFontColor() {
            dmFontColor = dmFontColorArr[clrNum];
            $("#fontColorSt a").removeClass("selected");
            $("#fontColorSt a").eq(clrNum).addClass("selected");
        }

        $("#fontSizeSt li").click(function() {
            ftNum = $(this).index();
            chgFontSize();
        });

        $("#fontColorSt li").click(function() {
            clrNum = $(this).index();
            chgFontColor();
        });

        $("#fstIptLst a").click(function() {
            $("#dmTxt").val($(this).html());
        });

        $("#send").click(function() {
            var dmTxt = $("#dmTxt").val();
            var paraNode = document.createElement("div");
            var pareToTop;

            //小技巧: 如果当前弹幕输入框中没有内容, 
            //点击发射按钮的话, 就直接将placeholder中的内容发送到弹幕墙
            if (dmTxt.length === 0) {
                dmTxt = $("#dmTxt").attr("placeholder");
            }

            $(paraNode).css({
                "fontSize": dmFontSize,
                "color": dmFontColor,
                "position": "absolute",
                //"left": ((dmAreaWidth * Math.random()) + "") + "px",
                "top": ((dmAreaHeight * Math.random()) + "") + "px"
            });

            $(paraNode).addClass("moveToLeft");
            $(paraNode).append(dmTxt);
            $("#dmArea").append(paraNode);
            pareToTop = $(paraNode).offset().top;

            //每次点击后随机变换字体和颜色
            ftNum = Math.floor(4 * Math.random());
            clrNum = Math.floor(4 * Math.random());
            chgFontSize();
            chgFontColor();
        });

        $("#clear").click(function() {
            $("#dmArea").empty();
        });
    });
    </script>
</body>

</html>
